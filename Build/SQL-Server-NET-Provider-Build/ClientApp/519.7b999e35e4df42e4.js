"use strict";(self.webpackChunkdocument_management=self.webpackChunkdocument_management||[]).push([[519],{1152:(T,d,n)=>{n.d(d,{U:()=>p});var m=n(3824);class p extends m.u{id="";createdBy="";categoryId="";documentStatusId="";storageSettingId="";createDate}},3824:(T,d,n)=>{n.d(d,{u:()=>m});class m{fields="";orderBy="";searchQuery="";pageSize=30;skip=0;name="";totalCount=0;metaTags=""}},7008:(T,d,n)=>{n.d(d,{M:()=>g});var m=n(4438),p=n(1626);let g=(()=>{class t{httpClient;constructor(c){this.httpClient=c}getAllCategories(){return this.httpClient.get("Category")}delete(c){return this.httpClient.delete(`Category/${c}`)}update(c){return this.httpClient.put(`Category/${c.id}`,c)}add(c){return this.httpClient.post("Category",c)}getSubCategories(c){return this.httpClient.get(`Category/${c}/subcategories`)}getAllCategoriesForDropDown(){return this.httpClient.get("Category/dropdown")}static \u0275fac=function(u){return new(u||t)(m.KVO(p.Qq))};static \u0275prov=m.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()},1519:(T,d,n)=>{n.r(d),n.d(d,{DocumentAuditTrailModule:()=>At});var m=n(177),p=n(1188),g=n(3870),t=n(4438),v=n(6695),c=n(2042),u=n(1152),E=n(7786),F=n(3726),S=n(8141),b=n(152),$=n(3294),j=n(8),D=n(4412),N=n(7673),R=n(9437),x=n(980);class M{documentAuditTrailService;documentAuditTrailsSubject=new D.t([]);responseHeaderSubject=new D.t(null);loadingSubject=new D.t(!1);loading$=this.loadingSubject.asObservable();_count=0;get count(){return this._count}responseHeaderSubject$=this.responseHeaderSubject.asObservable();constructor(i){this.documentAuditTrailService=i}connect(i){return this.documentAuditTrailsSubject.asObservable()}disconnect(i){this.documentAuditTrailsSubject.complete(),this.loadingSubject.complete()}loadDocumentAuditTrails(i){this.loadingSubject.next(!0),this.documentAuditTrailService.getDocumentAuditTrials(i).pipe((0,R.W)(()=>(0,N.of)([])),(0,x.j)(()=>this.loadingSubject.next(!1))).subscribe(o=>{const s=JSON.parse(o.headers.get("X-Pagination"));this.responseHeaderSubject.next(s);const a=[...o.body];this._count=a.length,this.documentAuditTrailsSubject.next(a)})}}var O=n(2899),A=n(1626),B=n(7598);let G=(()=>{class e{httpClient;commonHttpErrorService;constructor(o,s){this.httpClient=o,this.commonHttpErrorService=s}getDocumentAuditTrials(o){const a=(new A.Nl).set("Fields",o.fields).set("OrderBy",o.orderBy).set("PageSize",o.pageSize.toString()).set("Skip",o.skip.toString()).set("SearchQuery",o.searchQuery).set("categoryId",o.categoryId).set("name",o.name).set("id",o.id.toString()).set("createdBy",o.createdBy.toString());return this.httpClient.get("documentAuditTrail",{params:a,observe:"response"}).pipe((0,R.W)(this.commonHttpErrorService.handleError))}static \u0275fac=function(s){return new(s||e)(t.KVO(A.Qq),t.KVO(B.T))};static \u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var k=n(7008),U=n(9301),V=n(7542),L=n(6292),l=n(9159),I=n(2798),Y=n(6600),H=n(9036),h=n(9454),y=n(3955),w=n(9519);const P=["input"],z=e=>({"margin-left.px":e}),_=()=>[10,20,30];function X(e,i){if(1&e&&(t.j41(0,"div")(1,"b"),t.EFF(2),t.k0s()()),2&e){const o=t.XpG().$implicit;t.R7$(2),t.SpI(" ",o.name,"")}}function W(e,i){if(1&e&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&e){const o=t.XpG().$implicit;t.R7$(),t.SpI(" ",o.name," ")}}function Q(e,i){if(1&e&&(t.j41(0,"mat-option",14)(1,"div",37),t.DNE(2,X,3,1,"div",38)(3,W,2,1,"div",38),t.k0s()()),2&e){const o=i.$implicit;t.Y8G("value",o.id),t.R7$(),t.Y8G("ngStyle",t.eq3(4,z,20*o.deafLevel)),t.R7$(),t.Y8G("ngIf",!o.parentId),t.R7$(),t.Y8G("ngIf",o.parentId)}}function K(e,i){if(1&e&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&e){const o=i.$implicit;t.Y8G("value",o.id),t.R7$(),t.Lme(" ",o.firstName," ",o.lastName," ")}}function J(e,i){1&e&&(t.j41(0,"th",39),t.EFF(1),t.nI1(2,"translate"),t.nI1(3,"translate"),t.k0s()),2&e&&(t.R7$(),t.Lme(" ",t.bMT(2,2,"ACTION")," ",t.bMT(3,4,"DATE")," "))}function Z(e,i){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.nI1(2,"utcToLocalTime"),t.k0s()),2&e){const o=i.$implicit;t.R7$(),t.SpI(" ",t.i5U(2,1,null==o?null:o.createdDate,"full")," ")}}function q(e,i){1&e&&(t.j41(0,"th",41),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"NAME")," "))}function tt(e,i){if(1&e){const o=t.RV6();t.j41(0,"td",40)(1,"a",42),t.bIt("click",function(){const a=t.eBV(o).$implicit,r=t.XpG();return t.Njj(r.onDocumentView(a))}),t.EFF(2),t.k0s()()}if(2&e){const o=i.$implicit;t.R7$(2),t.JRh(o.documentName)}}function et(e,i){1&e&&(t.j41(0,"th",41),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"CATEGORY_NAME")," "))}function ot(e,i){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.k0s()),2&e){const o=i.$implicit;t.R7$(),t.SpI(" ",o.categoryName," ")}}function nt(e,i){1&e&&(t.j41(0,"th",41),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"OPERATION")," "))}function it(e,i){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e){const o=i.$implicit;t.R7$(),t.SpI(" ",t.bMT(2,1,o.operationName.toUpperCase())," ")}}function at(e,i){1&e&&(t.j41(0,"th",41),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"BY_WHOM")," "))}function st(e,i){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.k0s()),2&e){const o=i.$implicit;t.R7$(),t.SpI(" ",null==o?null:o.createdBy," ")}}function rt(e,i){1&e&&(t.j41(0,"th",41),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"TO_WHOM_USER")," "))}function ct(e,i){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.k0s()),2&e){const o=i.$implicit;t.R7$(),t.SpI(" ",null==o?null:o.permissionUser," ")}}function lt(e,i){1&e&&(t.j41(0,"th",41),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"TO_WHOM_ROLE")," "))}function mt(e,i){if(1&e&&(t.j41(0,"td",40),t.EFF(1),t.k0s()),2&e){const o=i.$implicit;t.R7$(),t.SpI(" ",null==o?null:o.permissionRole," ")}}function ut(e,i){if(1&e&&(t.j41(0,"td",43),t.nrm(1,"mat-paginator",44),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.Y8G("length",o.documentResource.totalCount)("pageSize",o.documentResource.pageSize)("pageSizeOptions",t.lJ4(3,_))}}function dt(e,i){1&e&&t.nrm(0,"tr",45)}function pt(e,i){1&e&&t.nrm(0,"tr",46)}function ht(e,i){1&e&&t.nrm(0,"tr",47)}function ft(e,i){1&e&&(t.j41(0,"tr")(1,"td",48)(2,"div",49)(3,"b"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()()),2&e&&(t.R7$(4),t.SpI(" ",t.bMT(5,1,"NO_DATA_FOUND"),""))}function gt(e,i){1&e&&(t.j41(0,"div",50)(1,"div",51)(2,"span",52),t.EFF(3,"Loading..."),t.k0s()()())}const Tt=[{path:"",component:(()=>{class e extends j.${documentAuditTrailService;categoryService;commonService;overlay;breakpointsService;dataSource;documentAuditTrails=[];displayedColumns=["createdDate","documentName","categoryName","operationName","createdBy","permissionUser","permissionRole"];isLoadingResults=!0;documentResource;categories=[];allCategories=[];loading$;paginator;sort;input;users=[];footerToDisplayed=["footer"];step=(0,t.vPA)(0);constructor(o,s,a,r,f){super(),this.documentAuditTrailService=o,this.categoryService=s,this.commonService=a,this.overlay=r,this.breakpointsService=f,this.documentResource=new u.U,this.documentResource.pageSize=10,this.documentResource.orderBy="createdDate desc"}ngOnInit(){this.ismobileCheck(),this.dataSource=new M(this.documentAuditTrailService),this.dataSource.loadDocumentAuditTrails(this.documentResource),this.getCategories(),this.getResourceParameter(),this.getUsers()}ismobileCheck(){this.breakpointsService.isMobile$.subscribe(o=>{this.step.set(o?1:0)})}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,E.h)(this.sort.sortChange,this.paginator.page).pipe((0,S.M)(o=>{this.documentResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.documentResource.pageSize=this.paginator.pageSize,this.documentResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadDocumentAuditTrails(this.documentResource)})).subscribe(),this.sub$.sink=(0,F.R)(this.input.nativeElement,"keyup").pipe((0,b.B)(1e3),(0,$.F)(),(0,S.M)(()=>{this.paginator.pageIndex=0,this.documentResource.skip=0,this.documentResource.name=this.input.nativeElement.value,this.dataSource.loadDocumentAuditTrails(this.documentResource)})).subscribe()}onCategoryChange(o){this.documentResource.categoryId=o.value?o.value:"",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocumentAuditTrails(this.documentResource)}onUserChange(o){this.documentResource.createdBy=o.value?o.value:"",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocumentAuditTrails(this.documentResource)}getCategories(){this.categoryService.getAllCategoriesForDropDown().subscribe(o=>{this.categories=o,this.setDeafLevel()})}setDeafLevel(o,s){const a=this.categories.filter(r=>r.parentId==s);return a.length>0&&a.map((r,f)=>{r.deafLevel=o?o.deafLevel+1:0,r.index=(o?o.index:0)+f*Math.pow(.1,r.deafLevel),this.allCategories.push(r),this.setDeafLevel(r,r.id)}),o}getUsers(){this.sub$.sink=this.commonService.getUsersForDropdown().subscribe(o=>{this.users=o},o=>{o.messages.forEach(()=>{})})}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(o=>{o&&(this.documentResource.pageSize=o.pageSize,this.documentResource.skip=o.skip,this.documentResource.totalCount=o.totalCount)})}onDocumentView(o){const a=o.url.split(".")[1];this.overlay.open(O.X,{position:"center",origin:"global",panelClass:["file-preview-overlay-container","white-background"],data:{documentId:o.documentId,name:o.documentName,extension:a,isVersion:!1,isFromPublicPreview:!1,isPreviewDownloadEnabled:!1}})}static \u0275fac=function(s){return new(s||e)(t.rXU(G),t.rXU(k.M),t.rXU(U.h),t.rXU(V.j),t.rXU(L.s))};static \u0275cmp=t.VBU({type:e,selectors:[["app-document-audit-trail"]],viewQuery:function(s,a){if(1&s&&(t.GBs(v.iy,5),t.GBs(c.B4,5),t.GBs(P,5)),2&s){let r;t.mGM(r=t.lsd())&&(a.paginator=r.first),t.mGM(r=t.lsd())&&(a.sort=r.first),t.mGM(r=t.lsd())&&(a.input=r.first)}},features:[t.Vt3],decls:68,vars:34,consts:[["input",""],[1,"content"],[1,"container-fluid"],[1,"row","align-items-center"],[1,"col-md-6","mb-2"],[1,"mb-0","page-title"],[3,"code"],[1,"card"],[1,"header"],[3,"expanded"],[1,"d-flex","flex-wrap","flex-column","flex-sm-row"],[1,"p-1","flex-item","flex-fill"],[1,"form-control",3,"placeholder"],[1,"form-control",3,"selectionChange","placeholder"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"body"],[1,"table-responsive"],[1,"grid-height-medium"],["mat-table","","matSort","","matSortActive","createdDate","matSortDirection","desc",1,"w-100",3,"dataSource"],["matColumnDef","createdDate"],["class","table-column-fix-200","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","documentName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","categoryName"],["matColumnDef","operationName"],["matColumnDef","createdBy"],["matColumnDef","permissionUser"],["matColumnDef","permissionRole"],["matColumnDef","footer"],["mat-footer-cell","","colspan","7",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],[4,"matNoDataRow"],["class","spinner-container",4,"ngIf"],[1,"country-item",3,"ngStyle"],[4,"ngIf"],["mat-header-cell","","mat-sort-header","",1,"table-column-fix-200"],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],[1,"doc-link",3,"click"],["mat-footer-cell","","colspan","7"],[3,"length","pageSize","pageSizeOptions"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],["colspan","7"],[1,"m-2"],[1,"spinner-container"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"]],template:function(s,a){if(1&s){const r=t.RV6();t.j41(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"span",5),t.EFF(5),t.nI1(6,"translate"),t.k0s(),t.nrm(7,"app-page-help-text",6),t.k0s()(),t.j41(8,"div",7)(9,"div",8)(10,"mat-accordion")(11,"mat-expansion-panel",9)(12,"mat-expansion-panel-header")(13,"mat-panel-title"),t.EFF(14),t.nI1(15,"translate"),t.k0s()(),t.j41(16,"div",10)(17,"div",11),t.nrm(18,"input",12,0),t.nI1(20,"translate"),t.k0s(),t.j41(21,"div",11)(22,"mat-select",13),t.nI1(23,"translate"),t.bIt("selectionChange",function(C){return t.eBV(r),t.Njj(a.onCategoryChange(C))}),t.j41(24,"mat-option",14),t.EFF(25),t.nI1(26,"translate"),t.k0s(),t.DNE(27,Q,4,6,"mat-option",15),t.k0s()(),t.j41(28,"div",11)(29,"mat-select",13),t.nI1(30,"translate"),t.bIt("selectionChange",function(C){return t.eBV(r),t.Njj(a.onUserChange(C))}),t.j41(31,"mat-option",14),t.EFF(32),t.nI1(33,"translate"),t.k0s(),t.DNE(34,K,2,3,"mat-option",15),t.k0s()()()()()(),t.j41(35,"div",16)(36,"div",17)(37,"div",18)(38,"table",19),t.qex(39,20),t.DNE(40,J,4,6,"th",21)(41,Z,3,4,"td",22),t.bVm(),t.qex(42,23),t.DNE(43,q,3,3,"th",24)(44,tt,3,1,"td",22),t.bVm(),t.qex(45,25),t.DNE(46,et,3,3,"th",24)(47,ot,2,1,"td",22),t.bVm(),t.qex(48,26),t.DNE(49,nt,3,3,"th",24)(50,it,3,3,"td",22),t.bVm(),t.qex(51,27),t.DNE(52,at,3,3,"th",24)(53,st,2,1,"td",22),t.bVm(),t.qex(54,28),t.DNE(55,rt,3,3,"th",24)(56,ct,2,1,"td",22),t.bVm(),t.qex(57,29),t.DNE(58,lt,3,3,"th",24)(59,mt,2,1,"td",22),t.bVm(),t.qex(60,30),t.DNE(61,ut,2,4,"td",31),t.bVm(),t.DNE(62,dt,1,0,"tr",32)(63,pt,1,0,"tr",33)(64,ht,1,0,"tr",34)(65,ft,6,3,"tr",35),t.k0s()()()()()()(),t.DNE(66,gt,4,0,"div",36),t.nI1(67,"async")}2&s&&(t.R7$(5),t.JRh(t.bMT(6,18,"DOCUMENTS_AUDIT_TRAIL")),t.R7$(2),t.Y8G("code","DOCUMENTS_AUDIT_TRAIL"),t.R7$(4),t.Y8G("expanded",0===a.step()),t.R7$(3),t.SpI(" ",t.bMT(15,20,"FILTER")," "),t.R7$(4),t.FS9("placeholder",t.bMT(20,22,"SEARCH_DOCUMENT_BY_NAME")),t.R7$(4),t.FS9("placeholder",t.bMT(23,24,"SELECT_CATEGORY")),t.R7$(3),t.SpI("-- ",t.bMT(26,26,"NONE")," --"),t.R7$(2),t.Y8G("ngForOf",a.allCategories),t.R7$(2),t.FS9("placeholder",t.bMT(30,28,"SELECT_USER")),t.R7$(3),t.SpI("-- ",t.bMT(33,30,"NONE")," --"),t.R7$(2),t.Y8G("ngForOf",a.users),t.R7$(4),t.Y8G("dataSource",a.dataSource),t.R7$(24),t.Y8G("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),t.R7$(),t.Y8G("matRowDefColumns",a.displayedColumns),t.R7$(),t.Y8G("matFooterRowDef",a.footerToDisplayed)("matFooterRowDefSticky",!0),t.R7$(2),t.Y8G("ngIf",t.bMT(67,32,a.dataSource.loading$)))},dependencies:[m.Sq,m.bT,m.B3,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.Zq,l.xW,l.KS,l.$R,l.Qo,l.YZ,l.NB,l.iF,l.ky,I.VO,Y.wT,c.B4,c.aE,v.iy,H.J,h.BS,h.GK,h.Z2,h.WN,m.Jj,y.D9,w.o]})}return e})(),data:{claimType:"document_audit_trail_view_document_audit_trail"},canActivate:[g.q]}];let vt=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=t.$C({type:e});static \u0275inj=t.G2t({imports:[p.iI.forChild(Tt),p.iI]})}return e})();var Dt=n(450),Ct=n(9631),St=n(3887),Rt=n(3679);let At=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=t.$C({type:e});static \u0275inj=t.G2t({imports:[m.MD,vt,l.tP,I.Ve,Dt.mV,c.NQ,v.Ou,Ct.fS,y.h,St.G,Rt.Y,h.MY]})}return e})()}}]);