"use strict";(self.webpackChunkdocument_management=self.webpackChunkdocument_management||[]).push([[127],{127:(B,d,l)=>{l.r(d),l.d(d,{CompanyProfileComponent:()=>A});var f=l(177),n=l(4438),s=l(9417),u=l(3955),h=l(1626),y=l(9437),I=l(7598);let C=(()=>{class o{commonHttpErrorService=(0,n.WQX)(I.T);httpClient=(0,n.WQX)(h.Qq);updateCompanyProfile(t,r,e){const a=`companyprofile/${t.id}`,i=new FormData;return i.append("id",t.id),i.append("name",t.name),r&&i.append("logoFile",r),e&&i.append("bannerFile",e),this.httpClient.post(a,i).pipe((0,y.W)(this.commonHttpErrorService.handleError))}static \u0275fac=function(r){return new(r||o)};static \u0275prov=n.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var g=l(1188),F=l(8834),b=l(5794),E=l(2243),v=l(5464),P=l(9213),c=l(5596),U=l(7945),T=l(3887),R=l(9036);const N=["logoUpload"],S=["bannerUpload"],_=()=>["/dashboard"];function G(o,p){1&o&&(n.j41(0,"div"),n.EFF(1),n.nI1(2,"translate"),n.k0s()),2&o&&(n.R7$(),n.SpI(" ",n.bMT(2,1,"COMPANY_TITLE_IS_REQUIRED")," "))}function j(o,p){if(1&o&&(n.j41(0,"div",33),n.DNE(1,G,3,3,"div",34),n.k0s()),2&o){let t;const r=n.XpG();n.R7$(),n.Y8G("ngIf",null==(t=r.companyProfileForm.get("companyTitle"))||null==t.errors?null:t.errors.required)}}function M(o,p){if(1&o&&n.nrm(0,"img",35),2&o){const t=n.XpG();n.Y8G("src",t.logoUrl,n.B4B)}}function L(o,p){1&o&&(n.j41(0,"div"),n.EFF(1),n.nI1(2,"translate"),n.k0s()),2&o&&(n.R7$(),n.SpI(" ",n.bMT(2,1,"COMPANY_LOGO_IS_REQUIRED")," "))}function O(o,p){if(1&o&&(n.j41(0,"div",33),n.DNE(1,L,3,3,"div",34),n.k0s()),2&o){let t;const r=n.XpG();n.R7$(),n.Y8G("ngIf",null==(t=r.companyProfileForm.get("logo"))||null==t.errors?null:t.errors.required)}}function k(o,p){if(1&o&&n.nrm(0,"img",36),2&o){const t=n.XpG();n.Y8G("src",t.bannerUrl,n.B4B)}}function Y(o,p){1&o&&(n.j41(0,"div"),n.EFF(1),n.nI1(2,"translate"),n.k0s()),2&o&&(n.R7$(),n.SpI(" ",n.bMT(2,1,"COMPANY_BANNER_IS_REQUIRED")," "))}function $(o,p){if(1&o&&(n.j41(0,"div",33),n.DNE(1,Y,3,3,"div",34),n.k0s()),2&o){let t;const r=n.XpG();n.R7$(),n.Y8G("ngIf",null==(t=r.companyProfileForm.get("banner"))||null==t.errors?null:t.errors.required)}}let A=(()=>{class o{fb;logoUploadInput;bannerUploadInput;companyProfileForm;companyProfileService=(0,n.WQX)(C);toastrService=(0,n.WQX)(b.tw);translationService=(0,n.WQX)(E.L);securityService=(0,n.WQX)(U.i);companyId="";logoUrl=null;bannerUrl=null;constructor(t){this.fb=t}ngOnInit(){this.createFormGroup(),this.getCompanyProfile()}createFormGroup(){this.companyProfileForm=this.fb.group({companyTitle:["",[s.k0.required,s.k0.maxLength(100)]],logo:[this.logoUrl],banner:[this.bannerUrl]})}triggerLogoUpload(t){t.click()}triggerBannerUpload(t){t.click()}onLogoUpload(t){const r=t.target.files[0];if(r){const e=new FileReader;e.onload=a=>{this.companyProfileForm.patchValue({logo:a.target?.result}),this.logoUrl=a.target?.result},e.readAsDataURL(r)}}onBannerUpload(t){const r=t.target.files[0];if(r){const e=new FileReader;e.onload=a=>{this.companyProfileForm.patchValue({banner:a.target?.result}),this.bannerUrl=a.target?.result},e.readAsDataURL(r)}}onSave(){if(this.companyProfileForm.invalid)return;const t={id:this.companyId,name:this.companyProfileForm.get("companyTitle")?.value},r=this.logoUploadInput?.nativeElement,e=this.bannerUploadInput?.nativeElement,a=r.files?.item(0)||null,i=e.files?.item(0)||null;this.companyProfileService.updateCompanyProfile(t,a,i).subscribe({next:m=>{this.securityService.setCompany(m),this.toastrService.success(this.translationService.getValue("COMPANY_PROFILE_UPDATED_SUCCESSFULLY"))},error:()=>{this.toastrService.error(this.translationService.getValue("FAILED_TO_SAVE_COMPANY_PROFILE"))}})}getCompanyProfile(){this.securityService.companyProfile.subscribe(t=>{t&&(this.companyProfileForm.patchValue({companyTitle:t.name,logoUrl:t.logoUrl,bannerUrl:t.bannerUrl,companyId:t.id}),this.logoUrl=t.logoUrl,this.bannerUrl=t.bannerUrl,this.companyId=t.id)})}static \u0275fac=function(r){return new(r||o)(n.rXU(s.ok))};static \u0275cmp=n.VBU({type:o,selectors:[["app-company-profile"]],viewQuery:function(r,e){if(1&r&&(n.GBs(N,5),n.GBs(S,5)),2&r){let a;n.mGM(a=n.lsd())&&(e.logoUploadInput=a.first),n.mGM(a=n.lsd())&&(e.bannerUploadInput=a.first)}},standalone:!0,features:[n.aNF],decls:71,vars:39,consts:[["logoUpload",""],["bannerUpload",""],[1,"content"],[1,"container-fluid"],[3,"formGroup"],[1,"row","align-items-center"],[1,"col-md-6","mb-2"],[1,"mb-0","page-title"],["code","COMPANY_PROFILE"],[1,"card"],[1,"header"],[1,"row"],[1,"col-md-6"],[1,"col-md-12"],[1,"form-group"],["for","companyTitle"],["type","text","id","companyTitle","formControlName","companyTitle","placeholder","Enter company title",1,"form-control"],["class","text-danger",4,"ngIf"],["for","logoUpload"],["appearance","outlined",1,"example-card"],["mat-card-image","","alt","Company Logo","width","200","height","55",3,"src",4,"ngIf"],["type","file","accept","image/*","hidden","",3,"change"],["color","primary",1,"btn","btn-success","btn-sm","me-2",3,"click"],["name","image",1,"small-icon"],[1,"col-sm-12"],[1,"font-weight-bold","text-danger"],["for","bannerUpload"],["mat-card-image","","alt","Company Banner","width","1000","height","500",3,"src",4,"ngIf"],[1,"m-top-10"],[1,"btn","btn-success","btn-sm","me-2",3,"click","disabled"],["name","save",1,"small-icon"],[1,"btn","btn-danger","btn-sm",3,"routerLink"],["name","x-circle",1,"small-icon"],[1,"text-danger"],[4,"ngIf"],["mat-card-image","","alt","Company Logo","width","200","height","55",3,"src"],["mat-card-image","","alt","Company Banner","width","1000","height","500",3,"src"]],template:function(r,e){if(1&r){const a=n.RV6();n.j41(0,"section",2)(1,"div",3)(2,"form",4)(3,"div",5)(4,"div",6)(5,"span",7),n.EFF(6),n.nI1(7,"translate"),n.nrm(8,"app-page-help-text",8),n.k0s()()(),n.j41(9,"div",9)(10,"div",10)(11,"div",11)(12,"div",12)(13,"div",13)(14,"div",14)(15,"label",15),n.EFF(16),n.nI1(17,"translate"),n.k0s(),n.nrm(18,"input",16),n.DNE(19,j,2,1,"div",17),n.k0s()(),n.j41(20,"div",13)(21,"div",14)(22,"label",18),n.EFF(23),n.nI1(24,"translate"),n.k0s(),n.j41(25,"mat-card",19),n.DNE(26,M,1,1,"img",20),n.j41(27,"mat-card-content")(28,"div",14)(29,"input",21,0),n.bIt("change",function(m){return n.eBV(a),n.Njj(e.onLogoUpload(m))}),n.k0s(),n.j41(31,"button",22),n.bIt("click",function(){n.eBV(a);const m=n.sdS(30);return n.Njj(e.triggerLogoUpload(m))}),n.nrm(32,"i-feather",23),n.EFF(33),n.nI1(34,"translate"),n.k0s()(),n.j41(35,"div",11)(36,"div",24)(37,"span",25),n.EFF(38),n.nI1(39,"translate"),n.k0s()()(),n.DNE(40,O,2,1,"div",17),n.k0s()()()()(),n.j41(41,"div",12)(42,"div",14)(43,"label",26),n.EFF(44),n.nI1(45,"translate"),n.k0s(),n.j41(46,"mat-card",19),n.DNE(47,k,1,1,"img",27),n.j41(48,"mat-card-content")(49,"div",14)(50,"input",21,1),n.bIt("change",function(m){return n.eBV(a),n.Njj(e.onBannerUpload(m))}),n.k0s(),n.j41(52,"button",22),n.bIt("click",function(){n.eBV(a);const m=n.sdS(51);return n.Njj(e.triggerBannerUpload(m))}),n.nrm(53,"i-feather",23),n.EFF(54),n.nI1(55,"translate"),n.k0s()(),n.j41(56,"div",11)(57,"div",24)(58,"span",25),n.EFF(59),n.nI1(60,"translate"),n.k0s()()(),n.DNE(61,$,2,1,"div",17),n.k0s()()()(),n.j41(62,"div",28)(63,"button",29),n.bIt("click",function(){return n.eBV(a),n.Njj(e.onSave())}),n.nrm(64,"i-feather",30),n.EFF(65),n.nI1(66,"translate"),n.k0s(),n.j41(67,"button",31),n.nrm(68,"i-feather",32),n.EFF(69),n.nI1(70,"translate"),n.k0s()()()()()()()()}if(2&r){let a,i,m;n.R7$(2),n.Y8G("formGroup",e.companyProfileForm),n.R7$(4),n.JRh(n.bMT(7,18,"COMPANY_PROFILE")),n.R7$(10),n.JRh(n.bMT(17,20,"COMPANY_TITLE")),n.R7$(3),n.Y8G("ngIf",(null==(a=e.companyProfileForm.get("companyTitle"))?null:a.touched)&&(null==(a=e.companyProfileForm.get("companyTitle"))?null:a.invalid)),n.R7$(4),n.SpI(" ",n.bMT(24,22,"COMPANY_LOGO"),""),n.R7$(3),n.Y8G("ngIf",e.logoUrl),n.R7$(7),n.SpI(" ",n.bMT(34,24,"CHANGE_LOGO")," "),n.R7$(5),n.SpI(" ",n.bMT(39,26,"THE_LOGO_SIZE_NOTE")," "),n.R7$(2),n.Y8G("ngIf",(null==(i=e.companyProfileForm.get("logo"))?null:i.touched)&&(null==(i=e.companyProfileForm.get("logo"))?null:i.invalid)),n.R7$(4),n.SpI(" ",n.bMT(45,28,"COMPANY_BANNER"),""),n.R7$(3),n.Y8G("ngIf",e.bannerUrl),n.R7$(7),n.SpI(" ",n.bMT(55,30,"CHANGE_BANNER")," "),n.R7$(5),n.SpI(" ",n.bMT(60,32,"THE_BANNER_SIZE_NOTE")," "),n.R7$(2),n.Y8G("ngIf",(null==(m=e.companyProfileForm.get("banner"))?null:m.touched)&&(null==(m=e.companyProfileForm.get("banner"))?null:m.invalid)),n.R7$(2),n.Y8G("disabled",e.companyProfileForm.invalid),n.R7$(2),n.SpI(" ",n.bMT(66,34,"SAVE")," "),n.R7$(2),n.Y8G("routerLink",n.lJ4(38,_)),n.R7$(2),n.SpI(" ",n.bMT(70,36,"CANCEL")," ")}},dependencies:[s.YN,s.qT,s.me,s.BC,s.cb,u.h,u.D9,f.MD,f.bT,g.iI,g.Wk,F.Hl,s.X1,s.j4,s.JD,v.M,v.X,P.m_,c.Hu,c.RN,c.m2,c.kF,T.G,R.J]})}return o})()}}]);